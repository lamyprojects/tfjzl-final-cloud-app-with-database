<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Exam Result</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>

<div class="container mt-4">

  <a class="btn btn-link p-0 mb-3" href="{% url 'onlinecourse:index' %}">Home</a>

  <h2 class="mb-3">Exam results</h2>

  {% if passed %}
    <div class="alert alert-success">
      <h4 class="mb-1">Congratulations ðŸŽ‰</h4>
      <div><strong>Score:</strong> {{ total_score }} / {{ max_score }} ({{ percentage }}%)</div>
    </div>
  {% else %}
    <div class="alert alert-danger">
      <h4 class="mb-1">Re-test</h4>
      <div><strong>Score:</strong> {{ total_score }} / {{ max_score }} ({{ percentage }}%)</div>
    </div>
  {% endif %}

  <hr>

  {% for r in question_results %}
    <div class="card mb-3">
      <div class="card-header">
        <strong>{{ r.question.question_text }}</strong> ({{ r.grade }} pts)
      </div>
      <div class="card-body">
        <p class="mb-1"><strong>Your answer:</strong>
          {% if r.selected_for_q %}
            {% for c in r.selected_for_q %}
              <span class="badge badge-secondary">{{ c.choice_text }}</span>
            {% endfor %}
          {% else %}
            <span class="text-muted">No answer selected</span>
          {% endif %}
        </p>

        <p class="mb-2"><strong>Correct answer:</strong>
          {% for c in r.correct_for_q %}
            <span class="badge badge-success">{{ c.choice_text }}</span>
          {% endfor %}
        </p>

        {% if r.is_correct %}
          <span class="badge badge-success">Correct</span>
        {% else %}
          <span class="badge badge-danger">Incorrect</span>
        {% endif %}
      </div>
    </div>
  {% endfor %}

  <a class="btn btn-primary mt-2" href="{% url 'onlinecourse:course_details' course.id %}">Back to course</a>

</div>

</body>
</html>